<?xml version="1.0" encoding="UTF-8"?>
<extractor>
    <filter header="From" match="@brusselsairlines.com"/>

    <variable match="Booking reference:\s+([A-Z0-9]{6})" name="bookingRef" value="${1}"/>
    <class type="FlightReservation" match="Departure|Return" repeat="true">
        <property name="reservationNumber" value="${bookingRef}"/>
        <class type="Flight" name="reservationFor">
            <class type="Airport" name="departureAirport">
                <property name="name" match="([A-Z][\S ]*)\n" value="${1}"/>
            </class>
            <property name="departureTime" match="([0-9]{2} [A-Za-z]{3} [0-9]{4}),\s*([0-9]{2}:[0-9]{2})" value="${1} ${2}" type="dateTime" format="dd MMM yyyy hh:mm"/>
            <class type="Airport" name="arrivalAirport">
                <property name="name" match="([A-Z][\S ]*)\n" value="${1}"/>
            </class>
            <property name="arrivalTime" match="([0-9]{2} [A-Za-z]{3} [0-9]{4}),\s*([0-9]{2}:[0-9]{2})" value="${1} ${2}" type="dateTime" format="dd MMM yyyy hh:mm"/>

            <variable name="airlineCode" match="[A-Z0-9]{2}" value="${0}"/>
            <property name="flightNumber" match="[0-9]{3,4}" value="${0}"/>
            <class type="Airline" name="airline">
                <property name="iataCode" value="${airlineCode}"/>
                <property name="name" match="([A-Z][A-Za-z0-9 ]*)\n" value="${1}"/>
            </class>
        </class>
    </class>
</extractor>

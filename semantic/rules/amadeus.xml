<?xml version="1.0" encoding="UTF-8"?>
<extractor>
    <filter header="From" match="@amadeus.com"/>

    <variable match="BOOKING REF: ([A-Z0-9]{6})" name="bookingRef" value="${1}"/>
    <class type="FlightReservation" match="FLIGHT  " repeat="true">
        <property name="reservationNumber" value="${bookingRef}"/>
        <class type="Flight" name="reservationFor">
            <variable name="airlineCode" match="[A-Z0-9]{2}" value="${0}"/>
            <property name="flightNumber" match="[0-9]{3,4}" value="${0}"/>
            <class type="Airline" name="airline">
                <property name="iataCode" value="${airlineCode}"/>
                <property name="name" match="- ([A-Za-z0-9 ]*?)  " value="${1}"/>
            </class>
            <variable name="year" match="([0-9]{4})\n" value="${1}"/>
            <class type="Airport" name="departureAirport">
                <property name="name" match="DEPARTURE: (.*?) [ -]" value="${1}"/>
            </class>
            <property name="departureTime" match="([0-9]{2}) ([A-Z]{3}) ([0-9]{2}:[0-9]{2})" value="${1} ${2} ${year} ${3}" type="dateTime" format="dd MMM yyyy hh:mm"/>
            <class type="Airport" name="arrivalAirport">
                <property name="name" match="ARRIVAL: *(.*?) [ -]" value="${1}"/>
            </class>
            <property name="arrivalTime" match="([0-9]{2}) ([A-Z]{3}) ([0-9]{2}:[0-9]{2})" value="${1} ${2} ${year} ${3}" type="dateTime" format="dd MMM yyyy hh:mm"/>
        </class>
  </class>
</extractor>
